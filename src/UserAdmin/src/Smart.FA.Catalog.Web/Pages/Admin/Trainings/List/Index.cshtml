@page
@using Microsoft.Extensions.Localization
@inject IStringLocalizer<CatalogResources> _localizer
@model Smart.FA.Catalog.Web.Pages.Admin.Trainings.List.ListModel
@{
    Layout = "_AdminLayout";
    ViewData["ToolBarTitle"] = @CatalogResources.MyTrainings;
    ViewData["Title"] = CatalogResources.MyTrainings;
}

@section HeaderToolbar {
    <div class="c-navbar c-navbar--bordered-bottom">
        <div class="c-toolbar">
            <div class="c-toolbar__left">
                <div class="c-toolbar__item">
                    <h2 class="c-toolbar__title">@CatalogResources.MyTrainings</h2>
                </div>
            </div>

            <smart-button-toolbar>
                <div class="c-toolbar__right">
                    <a href="/admin/trainings/create?fromlist=">
                        <smart-button label="@CatalogResources.AddNewTraining" leading-icon="Add"></smart-button>
                    </a>
                </div>
            </smart-button-toolbar>
        </div>
    </div>
}

<div class="o-card-grid small-up-1">
    @foreach (var training in Model.Trainings!)
    {
        @await Component.InvokeAsync("AdminTrainingTile", new { model = training})
    }
</div>

<div class="c-toolbar">
    <div class="c-toolbar__left">
        @if (Model?.Trainings?.HasPreviousPage ?? false)
        {
            <a asp-page="/admin/trainings/list/index" asp-route-CurrentPage="@(Model.CurrentPage - 1)">@CatalogResources.Previous</a>
        }
    </div>

    <div>Page @(Model?.CurrentPage ?? 0)/@(Model?.Trainings?.TotalPages ?? 0)</div>
    <div class="c-toolbar__right">
        @if (Model?.Trainings?.HasNextPage ?? false)
        {
            <a asp-page="/admin/trainings/list/index" asp-route-CurrentPage="@(Model.CurrentPage + 1)">@CatalogResources.Next</a>
        }
    </div>
</div>

<div id="delete-training-dialog-confirmation" class="c-dialog-context o-flex--center">
    <div class="c-dialog c-dialog--small" role="dialog">
        <div class="c-dialog__push"></div>
        <div class="c-dialog__body">
            <div class="c-dialog__content">
                <h3 class="c-h3">@CatalogResources.YouAreAboutToDeleteTraining</h3>
            </div>
        </div>
        <div class="c-dialog__footer">
            <div class="c-toolbar c-toolbar--spaced">
                <div class="c-toolbar__right">
                    <div class="c-toolbar__item">
                        <div class="c-button-toolbar">
                            <button class="c-button c-button--secondary" data-dialog-close="data-dialog-close">
                                <div class="c-button__content">
                                    <div class="c-button__label">@CatalogResources.Cancel</div>
                                </div>
                            </button>
                            <button id="delete-training-button" class="c-button c-button--primary" data-dialog-close="data-dialog-close" onclick="deleteTraining(this)">
                                <div class="c-button__content">
                                    <smart-icon icon="Delete"></smart-icon>
                                    <div class="c-button__label">@CatalogResources.Delete</div>
                                </div>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="c-dialog__push"></div>
    </div>
</div>

@section Scripts
{
    <script>
        // Submits the form surrounding the delete button of a training.
        function deleteTraining(elem) {
            document.getElementById('delete-training-form-' + elem.dataset.trainingid).submit();
        }

        // Used in the AdminTrainingTile HTML.
        function setTrainingId(trainingId) {
            document.getElementById('delete-training-button').dataset.trainingid = trainingId;
        }
    </script>
}
